<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Professional Bingo Ball Display</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;800;900&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      background: linear-gradient(135deg, #0a4b7a, #2c5aa0, #1e3c72);
      min-height: 100vh;
      font-family: 'Orbitron', monospace;
      color: white;
      overflow: hidden;
    }
    
    .main-container {
      width: 100vw;
      height: 100vh;
      position: relative;
      background: 
        radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
        linear-gradient(135deg, #0a4b7a 0%, #2c5aa0 50%, #1e3c72 100%);
    }
    
    .header-bar {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 80px;
      background: linear-gradient(90deg, #1a237e 0%, #283593 50%, #1a237e 100%);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 40px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      z-index: 100;
    }
    
    .logo-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .logo-text {
      font-size: 24px;
      font-weight: 900;
      background: linear-gradient(45deg, #00e5ff, #ffffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 20px rgba(0, 229, 255, 0.5);
    }
    
    .game-info {
      display: flex;
      gap: 30px;
      align-items: center;
      font-size: 14px;
    }
    
    .info-item {
      text-align: center;
    }
    
    .info-label {
      font-size: 12px;
      opacity: 0.8;
      margin-bottom: 2px;
    }
    
    .status-indicator {
      position: absolute;
      top: 100px;
      right: 20px;
      background: rgba(26, 35, 126, 0.9);
      padding: 10px 20px;
      border-radius: 20px;
      border: 2px solid rgba(0, 229, 255, 0.3);
      backdrop-filter: blur(10px);
      font-size: 14px;
      font-weight: 700;
      z-index: 100;
    }
    
    .status-live {
      color: #4caf50;
    }
    
    .status-waiting {
      color: #ff9800;
    }
    
    .status-countdown {
      color: #ffeb3b;
    }
    
    .status-disconnected {
      color: #f44336;
    }
    
    .info-value {
      font-size: 16px;
      font-weight: 700;
      color: #00e5ff;
    }
    
    .center-display {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 400px;
      height: 400px;
      z-index: 50;
    }
    
    .ball-machine {
      position: relative;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: 
        radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.2), transparent 70%),
        radial-gradient(circle at 70% 70%, rgba(0, 229, 255, 0.1), transparent 70%),
        linear-gradient(135deg, #1a237e 0%, #283593 50%, #1a237e 100%);
      box-shadow: 
        inset 0 0 50px rgba(0, 0, 0, 0.5),
        0 0 100px rgba(0, 229, 255, 0.3),
        0 0 200px rgba(0, 229, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    
    .ball-machine::before {
      content: '';
      position: absolute;
      width: 120%;
      height: 120%;
      border-radius: 50%;
      background: conic-gradient(
        from 0deg,
        transparent 0deg,
        rgba(0, 229, 255, 0.1) 90deg,
        transparent 180deg,
        rgba(0, 229, 255, 0.1) 270deg,
        transparent 360deg
      );
      animation: rotate 20s linear infinite;
    }
    
    @keyframes rotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .current-ball {
      position: relative;
      width: 280px;
      height: 280px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 120px;
      font-weight: 900;
      color: #fff;
      box-shadow: 
        inset -20px -20px 40px rgba(0, 0, 0, 0.2),
        inset 20px 20px 40px rgba(255, 255, 255, 0.8),
        0 0 50px rgba(0, 229, 255, 0.5);
      z-index: 10;
      transform: scale(0);
      transition: all 0.5s ease;
    }
    
    .current-ball.active {
      transform: scale(1);
    }
    
    .current-ball.bonus {
      border: 4px solid #ffd700;
      box-shadow: 
        inset -20px -20px 40px rgba(0, 0, 0, 0.2),
        inset 20px 20px 40px rgba(255, 255, 255, 0.8),
        0 0 60px rgba(255, 215, 0, 0.7);
      animation: pulse-glow 2s infinite;
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 60px rgba(255, 215, 0, 0.7); }
      50% { box-shadow: 0 0 80px rgba(255, 215, 0, 0.9); }
    }
    
    .ball-shine {
      position: absolute;
      width: 80px;
      height: 50px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.6);
      top: 50px;
      left: 60px;
      transform: rotate(-30deg);
      filter: blur(10px);
    }
    
    .ball-letter {
      position: absolute;
      top: -60px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 48px;
      font-weight: 900;
      color: #00e5ff;
      text-shadow: 0 0 20px rgba(0, 229, 255, 0.8);
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    
    .ball-letter.active {
      opacity: 1;
    }
    
    .side-panels {
      position: absolute;
      top: 80px;
      bottom: 0;
      left: 0;
      right: 0;
      display: flex;
    }
    
    .left-panel {
      width: 300px; /* Increased width to accommodate wider grid */
      background: rgba(26, 35, 126, 0.9);
      backdrop-filter: blur(10px);
      border-right: 2px solid rgba(0, 229, 255, 0.3);
      padding: 20px;
      overflow-y: auto;
    }
    
    .right-panel {
      width: 250px;
      background: rgba(26, 35, 126, 0.9);
      backdrop-filter: blur(10px);
      border-left: 2px solid rgba(0, 229, 255, 0.3);
      padding: 20px;
      overflow-y: auto;
      margin-left: auto;
    }
    
    .bonus-section {
      margin-bottom: 30px;
    }
    
    .bonus-title {
      font-size: 14px;
      font-weight: 700;
      color: #00e5ff;
      margin-bottom: 10px;
      text-align: center;
    }
    
    .bonus-amount {
      font-size: 24px;
      font-weight: 900;
      text-align: center;
      color: #fff;
      background: linear-gradient(135deg, #ff6b35, #f7931e);
      padding: 10px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
    }
    
    .bronze-amount {
      background: linear-gradient(135deg, #cd7f32, #daa520);
      box-shadow: 0 4px 15px rgba(205, 127, 50, 0.4);
    }
    
    .balls-section, .winners-section {
      margin-bottom: 20px;
    }
    
    .section-title {
      font-size: 14px;
      font-weight: 700;
      color: #00e5ff;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .balls-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      grid-template-rows: repeat(5, 1fr);
      gap: 12px; /* Increased gap for wider spacing */
      margin-bottom: 20px;
      justify-items: center; /* Center items in the grid */
    }
    
    .ball-item {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 700;
      color: #fff;
      box-shadow: 
        inset -5px -5px 10px rgba(0, 0, 0, 0.2),
        inset 5px 5px 10px rgba(255, 255, 255, 0.8),
        0 2px 10px rgba(0, 0, 0, 0.3);
      margin: 0 auto;
    }
    
    .ball-item.bonus {
      border: 3px solid #ffd700;
      box-shadow: 
        inset -5px -5px 10px rgba(0, 0, 0, 0.2),
        inset 5px 5px 10px rgba(255, 255, 255, 0.8),
        0 2px 10px rgba(255, 215, 0, 0.7);
    }
    
    .winners-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .winner-item {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.2), rgba(255, 193, 7, 0.1));
      border: 2px solid rgba(255, 215, 0, 0.4);
      border-radius: 8px;
      padding: 10px;
      font-size: 12px;
      font-weight: 600;
      color: white;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      animation: winnerFadeIn 0.5s ease-in;
    }
    
    @keyframes winnerFadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .call-display {
      position: absolute;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 24px;
      font-weight: 700;
      color: #00e5ff;
      text-align: center;
      background: rgba(26, 35, 126, 0.9);
      padding: 15px 30px;
      border-radius: 25px;
      border: 2px solid rgba(0, 229, 255, 0.3);
      backdrop-filter: blur(10px);
      min-width: 300px;
      box-shadow: 0 4px 20px rgba(0, 229, 255, 0.3);
      z-index: 100;
    }
    
    .floating-balls {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
      opacity: 0;
    }
    
    .floating-ball {
      position: absolute;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: 700;
      color: rgba(255, 255, 255, 0.6);
      border: 2px solid rgba(255, 255, 255, 0.1);
      animation: float 8s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
    }
    
    .floating-ball:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
    .floating-ball:nth-child(2) { top: 15%; right: 15%; animation-delay: 1s; }
    .floating-ball:nth-child(3) { bottom: 20%; left: 20%; animation-delay: 2s; }
    .floating-ball:nth-child(4) { bottom: 15%; right: 10%; animation-delay: 3s; }
    .floating-ball:nth-child(5) { top: 40%; left: 5%; animation-delay: 4s; }
    .floating-ball:nth-child(6) { top: 60%; right: 5%; animation-delay: 5s; }
    
    .controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
      z-index: 100;
    }
    
    .control-btn {
      background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
      border: 2px solid rgba(0, 229, 255, 0.5);
      color: white;
      padding: 12px 24px;
      border-radius: 25px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Orbitron', monospace;
      font-size: 14px;
    }
    
    .control-btn:hover {
      background: linear-gradient(135deg, #283593 0%, #1a237e 100%);
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.5);
      transform: translateY(-2px);
    }
    
    .control-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .recent-balls-horizontal {
      position: absolute;
      bottom: 200px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 100;
    }
    
    .recent-ball {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      font-weight: 700;
      color: #fff;
      box-shadow: 
        inset -3px -3px 6px rgba(0, 0, 0, 0.2),
        inset 3px 3px 6px rgba(255, 255, 255, 0.8),
        0 2px 8px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transform: scale(0);
      transition: all 0.5s ease;
    }
    
    .recent-ball.bonus {
      border: 3px solid #ffd700;
      box-shadow: 
        inset -3px -3px 6px rgba(0, 0, 0, 0.2),
        inset 3px 3px 6px rgba(255, 255, 255, 0.8),
        0 2px 8px rgba(255, 215, 0, 0.7);
    }
    
    .recent-ball.active {
      opacity: 1;
      transform: scale(1);
    }
    
    .waiting-animation {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 25;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    
    .waiting-animation.active {
      opacity: 1;
    }
    
    .bonus-showcase {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 40px;
      animation: fadeInUp 1s ease-out;
    }
    
    .showcase-title {
      font-size: 48px;
      font-weight: 900;
      background: linear-gradient(45deg, #00e5ff, #ffffff, #ffeb3b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 30px rgba(0, 229, 255, 0.5);
      animation: titleGlow 3s ease-in-out infinite alternate;
    }
    
    @keyframes titleGlow {
      0% { text-shadow: 0 0 30px rgba(0, 229, 255, 0.5); }
      100% { text-shadow: 0 0 50px rgba(0, 229, 255, 0.8), 0 0 80px rgba(255, 235, 59, 0.5); }
    }
    
    .bonus-container {
      width: 100%;
      height: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    
    .bonus-item {
      position: absolute;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
      padding: 40px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 3px solid transparent;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      width: 300px;
      height: 250px;
      transform: translateX(100vw);
      opacity: 0;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .bonus-item.slide-in {
      transform: translateX(0);
      opacity: 1;
    }
    
    .bonus-item.slide-out-left {
      transform: translateX(-100vw);
      opacity: 0;
    }
    
    .bonus-item.slide-out-right {
      transform: translateX(100vw);
      opacity: 0;
    }
    
    .bonus-bronze {
      border-color: #cd7f32;
      background: linear-gradient(135deg, rgba(205, 127, 50, 0.3), rgba(218, 165, 32, 0.2));
    }
    
    .bonus-silver {
      border-color: #c0c0c0;
      background: linear-gradient(135deg, rgba(192, 192, 192, 0.3), rgba(169, 169, 169, 0.2));
    }
    
    .bonus-gold {
      border-color: #ffd700;
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.3), rgba(255, 193, 7, 0.2));
    }
    
    .bonus-icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      position: relative;
      animation: iconPulse 1s ease-in-out infinite;
    }
    
    @keyframes iconPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }
    
    .bonus-icon::after {
      content: '';
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: inherit;
      filter: blur(15px);
      opacity: 0.6;
      z-index: -1;
    }
    
    .bronze-icon {
      background: linear-gradient(135deg, #cd7f32, #daa520);
      color: white;
    }
    
    .silver-icon {
      background: linear-gradient(135deg, #c0c0c0, #a9a9a9);
      color: white;
    }
    
    .gold-icon {
      background: linear-gradient(135deg, #ffd700, #ffc107);
      color: white;
    }
    
    .bonus-label {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    
    .bronze-label { 
      color: #cd7f32; 
      text-shadow: 0 0 20px rgba(205, 127, 50, 0.6);
    }
    .silver-label { 
      color: #c0c0c0; 
      text-shadow: 0 0 20px rgba(192, 192, 192, 0.6);
    }
    .gold-label { 
      color: #ffd700; 
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
    }
    
    .bonus-value {
      font-size: 42px;
      font-weight: 900;
      color: white;
      text-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      animation: valueGlow 1s ease-in-out infinite alternate;
    }
    
    @keyframes valueGlow {
      0% { 
        text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
        transform: scale(1);
      }
      100% { 
        text-shadow: 0 0 30px rgba(255, 255, 255, 0.8), 0 0 40px rgba(255, 255, 255, 0.4);
        transform: scale(1.08);
      }
    }
    
    .bonus-subtitle {
      font-size: 16px;
      opacity: 0.9;
      text-align: center;
      margin-top: 10px;
      color: white;
    }
    
    .slide-indicator {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
    }
    
    .slide-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .slide-dot.active {
      background: #00e5ff;
      box-shadow: 0 0 15px rgba(0, 229, 255, 0.6);
    }
    
    .waiting-message {
      margin-top: 40px;
      text-align: center;
      font-size: 24px;
      color: #00e5ff;
      animation: messagePulse 2s ease-in-out infinite;
    }
    
    @keyframes messagePulse {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }
    
    .sparkle {
      position: absolute;
      width: 6px;
      height: 6px;
      background: #fff;
      border-radius: 50%;
      animation: sparkle 2s ease-in-out infinite;
    }
    
    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }
    
    .particles {
      position: absolute;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 1;
    }
    
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 50%;
      animation: particleFloat 10s linear infinite;
    }
    
    @keyframes particleFloat {
      0% {
        transform: translateY(100vh) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100vh) rotate(360deg);
        opacity: 0;
      }
    }
    
    .countdown-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 100;
      opacity: 0;
      pointer-events: none;
    }
    
    .countdown-number {
      font-size: 200px;
      font-weight: 900;
      color: #ffeb3b;
      text-shadow: 0 0 30px rgba(255, 235, 59, 0.8);
      opacity: 0;
      transform: scale(0.5);
    }
    
    @keyframes countdownPop {
      0% { transform: scale(0.5); opacity: 0; }
      50% { transform: scale(1.2); opacity: 1; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(50px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .draw-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 200;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    
    .draw-screen.active {
      opacity: 1;
    }
    
    .draw-title {
      font-size: 72px;
      color: #ffeb3b;
      text-shadow: 0 0 20px #ffeb3b;
      margin-bottom: 20px;
    }
    
    .draw-message {
      font-size: 36px;
      color: #00e5ff;
      text-align: center;
      padding: 20px;
    }
    
    .draw-content {
      display: flex;
      gap: 40px;
      margin-top: 20px;
    }
    
    .draw-section {
      background: rgba(26, 35, 126, 0.9);
      padding: 20px;
      border-radius: 10px;
      border: 2px solid rgba(0, 229, 255, 0.3);
      backdrop-filter: blur(10px);
    }
    
    .draw-section-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 10px;
      text-align: center;
    }
    
    .draw-list {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      gap: 10px;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .draw-ball {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 700;
      color: #fff;
      box-shadow: inset -5px -5px 10px rgba(0, 0, 0, 0.2), inset 5px 5px 10px rgba(255, 255, 255, 0.8);
      margin: 0 auto;
    }
    
    .winner-display {
      margin-top: 20px;
      font-size: 36px;
      color: #ffd700;
      text-shadow: 0 0 20px #ffd700;
      text-align: center;
    }
    
    .jackpot-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #1a237e, #283593, #1a237e);
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      z-index: 300;
      opacity: 0;
      transition: opacity 0.5s ease;
    }
    
    .jackpot-screen.active {
      opacity: 1;
    }
    
    .jackpot-title {
      font-size: 80px;
      color: #ffd700;
      text-shadow: 0 0 30px #ffd700, 0 0 60px rgba(255, 215, 0, 0.5);
      animation: jackpotGlow 2s ease-in-out infinite alternate;
    }
    
    @keyframes jackpotGlow {
      0% { text-shadow: 0 0 30px #ffd700, 0 0 60px rgba(255, 215, 0, 0.5); }
      100% { text-shadow: 0 0 40px #ffd700, 0 0 80px rgba(255, 215, 0, 0.7); }
    }
    
    .jackpot-animation {
      display: flex;
      gap: 50px;
      margin-top: 20px;
    }
    
    .jackpot-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 15px;
      padding: 30px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 15px;
      border: 3px solid rgba(255, 215, 0, 0.5);
      animation: jackpotPulse 1.5s ease-in-out infinite;
    }
    
    @keyframes jackpotPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .jackpot-icon {
      font-size: 60px;
      color: #ffd700;
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
    }
    
    .jackpot-value {
      font-size: 36px;
      color: #fff;
      font-weight: 900;
      text-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
    }
  </style>
</head>
<body>
  <div class="main-container">
    <!-- Header Bar -->
    <div class="header-bar">
      <div class="logo-section">
        <div class="logo-text">BETWISE BINGO</div>
      </div>
      <div class="game-info">
        <div class="info-item">
          <div class="info-label">Game ID</div>
          <div class="info-value" id="game-id">Waiting...</div>
        </div>
        <div class="info-item">
          <div class="info-label">Balls Called</div>
          <div class="info-value" id="balls-called">0</div>
        </div>
        <div class="info-item">
          <div class="info-label">Remaining</div>
          <div class="info-value" id="balls-remaining">30</div>
        </div>
      </div>
    </div>
    
    <!-- Status Indicator -->
    <div class="status-indicator">
      <span id="status-text">‚óè WAITING FOR CASHIER</span>
    </div>
    
    <!-- Side Panels -->
    <div class="side-panels">
      <!-- Left Panel -->
      <div class="left-panel">
        <div class="bonus-section">
          <div class="bonus-title">SILVER BONUS</div>
          <div class="bonus-amount" id="silver-amount">792.56</div>
        </div>
        
        <div class="balls-section">
          <div class="section-title">PREVIOUS BALLS</div>
          <div class="balls-grid" id="left-balls"></div>
        </div>
      </div>
      
      <!-- Right Panel -->
      <div class="right-panel">
        <div class="bonus-section">
          <div class="bonus-title">BRONZE BONUS</div>
          <div class="bonus-amount bronze-amount" id="bronze-amount">705.66</div>
        </div>
        
        <div class="balls-section">
          <div class="section-title">RECENT CALLS</div>
          <div class="balls-grid" id="right-balls"></div>
        </div>
        
        <div class="winners-section">
          <div class="section-title">WINNERS</div>
          <div class="winners-list" id="winners-list"></div>
        </div>
      </div>
    </div>
    
    <!-- Waiting Animation -->
    <div class="waiting-animation active" id="waiting-animation">
      <div class="particles" id="particles"></div>
      <div class="bonus-showcase">
        <div class="showcase-title">üé∞ BONUS JACKPOTS üé∞</div>
        
        <div class="bonus-container">
          <div class="bonus-item bonus-bronze" id="bronze-bonus">
            <div class="bonus-icon bronze-icon">ü•â</div>
            <div class="bonus-label bronze-label">BRONZE</div>
            <div class="bonus-value" id="bronze-value">$705.66</div>
            <div class="bonus-subtitle">Minimum Prize</div>
          </div>
          
          <div class="bonus-item bonus-silver" id="silver-bonus">
            <div class="bonus-icon silver-icon">ü•à</div>
            <div class="bonus-label silver-label">SILVER</div>
            <div class="bonus-value" id="silver-value">$792.56</div>
            <div class="bonus-subtitle">Regular Prize</div>
          </div>
          
          <div class="bonus-item bonus-gold" id="gold-bonus">
            <div class="bonus-icon gold-icon">ü•á</div>
            <div class="bonus-label gold-label">GOLD</div>
            <div class="bonus-value" id="gold-value">$1,250.00</div>
            <div class="bonus-subtitle">Maximum Prize</div>
          </div>
          
          <div class="slide-indicator">
            <div class="slide-dot active" data-slide="0"></div>
            <div class="slide-dot" data-slide="1"></div>
            <div class="slide-dot" data-slide="2"></div>
          </div>
        </div>
        
        <div class="waiting-message">
          <div>üé≤ Waiting for Cashier to Start Game üé≤</div>
          <div style="font-size: 16px; margin-top: 10px; opacity: 0.8;">
            Get ready for exciting bingo action!
          </div>
        </div>
      </div>
    </div>
    
    <!-- Countdown Container -->
    <div class="countdown-container" id="countdown-container">
      <div class="countdown-number" id="countdown-number"></div>
    </div>
    
    <!-- Draw Screen -->
    <div class="draw-screen" id="draw-screen">
      <div class="draw-title">GAME DRAW</div>
      <div class="draw-message">Game has ended after 30 balls!</div>
      <div class="draw-content">
        <div class="draw-section">
          <div class="draw-section-title">Drawn Balls</div>
          <div class="draw-list" id="drawn-balls"></div>
        </div>
        <div class="draw-section">
          <div class="draw-section-title">Undrawn Balls</div>
          <div class="draw-list" id="undrawn-balls"></div>
        </div>
      </div>
      <div class="winner-display" id="winner-display"></div>
    </div>
    
    <!-- Jackpot Screen -->
    <div class="jackpot-screen" id="jackpot-screen">
      <div class="jackpot-title">üéâ JACKPOT BONUS! üéâ</div>
      <div class="jackpot-animation">
        <div class="jackpot-item">
          <div class="jackpot-icon">ü•â</div>
          <div class="jackpot-value" id="jackpot-bronze">$705.66</div>
        </div>
        <div class="jackpot-item">
          <div class="jackpot-icon">ü•à</div>
          <div class="jackpot-value" id="jackpot-silver">$792.56</div>
        </div>
        <div class="jackpot-item">
          <div class="jackpot-icon">ü•á</div>
          <div class="jackpot-value" id="jackpot-gold">$1,250.00</div>
        </div>
      </div>
    </div>
    
    <!-- Floating Background Balls -->
    <div class="floating-balls" id="floating-balls">
      <div class="floating-ball">7</div>
      <div class="floating-ball">19</div>
      <div class="floating-ball">32</div>
      <div class="floating-ball">45</div>
      <div class="floating-ball">12</div>
      <div class="floating-ball">28</div>
    </div>
    
    <!-- Center Display -->
    <div class="center-display">
      <div class="ball-machine">
        <div class="current-ball" id="current-ball">
          <div class="ball-shine"></div>
          <span id="ball-number"></span>
        </div>
        <div class="ball-letter" id="ball-letter"></div>
      </div>
    </div>
    
    <!-- Recent Balls Horizontal -->
    <div class="recent-balls-horizontal" id="recent-balls"></div>
    
    <!-- Call Display -->
    <div class="call-display" id="call-display">Waiting for cashier to start game...</div>
    
    <!-- Controls -->
    <div class="controls">
      <button class="control-btn" id="sync-game">SYNC WITH CASHIER</button>
      <button class="control-btn" id="toggle-sound">SOUND ON</button>
      <button class="control-btn" id="fullscreen">FULLSCREEN</button>
    </div>
  </div>

  <script>
    // Game State (Synced with server)
    let gameState = {
      gameId: null,
      availableBalls: Array.from({length: 30}, (_, i) => i + 1),
      drawnBalls: [],
      bonusBall: null,
      bonusAmounts: { bronze: 705.66, silver: 792.56, gold: 1250.00 },
      gameHistory: [],
      players: [],
      winner: null,
      isRunning: false,
      isCountingDown: false,
      recentBalls: [],
      lastUpdate: Date.now(),
      drawStartTime: null,
      drawEndTime: null
    };

    // Display state
    let displayState = {
      soundEnabled: true,
      isFullscreen: false,
      isConnected: false,
      isCashierConnected: false
    };

    // DOM Elements
    const currentBall = document.getElementById('current-ball');
    const ballNumber = document.getElementById('ball-number');
    const ballLetter = document.getElementById('ball-letter');
    const callDisplay = document.getElementById('call-display');
    const ballsCalled = document.getElementById('balls-called');
    const ballsRemaining = document.getElementById('balls-remaining');
    const gameIdElement = document.getElementById('game-id');
    const leftBalls = document.getElementById('left-balls');
    const rightBalls = document.getElementById('right-balls');
    const winnersList = document.getElementById('winners-list');
    const syncGameBtn = document.getElementById('sync-game');
    const toggleSoundBtn = document.getElementById('toggle-sound');
    const fullscreenBtn = document.getElementById('fullscreen');
    const statusText = document.getElementById('status-text');
    const waitingAnimation = document.getElementById('waiting-animation');
    const countdownContainer = document.getElementById('countdown-container');
    const countdownNumber = document.getElementById('countdown-number');
    const recentBalls = document.getElementById('recent-balls');
    const drawScreen = document.getElementById('draw-screen');
    const drawnBallsList = document.getElementById('drawn-balls');
    const undrawnBallsList = document.getElementById('undrawn-balls');
    const winnerDisplay = document.getElementById('winner-display');
    const jackpotScreen = document.getElementById('jackpot-screen');
    const floatingBalls = document.getElementById('floating-balls');
    const bronzeAmount = document.getElementById('bronze-amount');
    const silverAmount = document.getElementById('silver-amount');
    const bronzeValue = document.getElementById('bronze-value');
    const silverValue = document.getElementById('silver-value');
    const goldValue = document.getElementById('gold-value');
    const jackpotBronze = document.getElementById('jackpot-bronze');
    const jackpotSilver = document.getElementById('jackpot-silver');
    const jackpotGold = document.getElementById('jackpot-gold');

    // Dynamic port detection
    async function getServerPort() {
      try {
        const response = await fetch('http://localhost:3000/port', {
          signal: AbortSignal.timeout(2000),
          headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
        });
        const data = await response.json();
        return data.port || 3000;
      } catch (err) {
        console.error('Failed to fetch server port:', err);
        showNotification('Failed to connect to server', 'error');
        return 3000;
      }
    }

    // Socket.io connection
    let socket;
    async function initSocket() {
      const token = localStorage.getItem('token');
      if (!token) {
        showNotification('Please log in first', 'error');
        window.location.href = '/index.html';
        return;
      }
      const port = await getServerPort();
      socket = io(`http://localhost:${port}`, { 
        reconnectionAttempts: 5, 
        reconnectionDelay: 1000,
        timeout: 10000,
        auth: { token }
      });
      
      socket.on('connect', () => {
        displayState.isConnected = true;
        socket.emit('authenticate', token);
      });

      socket.on('authenticated', ({ role }) => {
        displayState.isConnected = true;
        socket.emit('requestGameState');
        showNotification(`Connected as ${role}`, 'success');
      });

      socket.on('authError', (message) => {
        showNotification('Authentication failed. Please log in again.', 'error');
        localStorage.removeItem('token');
        window.location.href = '/index.html';
      });

      socket.on('connect_error', (err) => {
        displayState.isConnected = false;
        updateGameStatus();
        showNotification(`Connection error: ${err.message}`, 'error');
      });

      socket.on('disconnect', () => {
        displayState.isConnected = false;
        displayState.isCashierConnected = false;
        gameState.isCountingDown = false;
        updateGameStatus();
        showNotification('Disconnected from server', 'error');
      });

      socket.on('cashierConnected', (data) => {
        displayState.isCashierConnected = data.cashierCount > 0;
        updateGameStatus();
        showNotification(`Cashier connected (${data.cashierCount})`, 'success');
      });

      socket.on('cashierDisconnected', (data) => {
        displayState.isCashierConnected = data.cashierCount > 0;
        gameState.isCountingDown = false;
        updateGameStatus();
        showNotification('Cashier disconnected', 'warning');
      });

      socket.on('cashierStatus', (data) => {
        displayState.isCashierConnected = data.isCashierConnected;
        updateGameStatus();
        if (data.isCashierConnected) {
          showNotification('Cashier is connected', 'success');
        } else {
          showNotification('Waiting for cashier to connect', 'warning');
        }
      });

      socket.on('gameState', (newState) => {
        gameState = { ...newState };
        gameIdElement.textContent = gameState.gameId || 'Waiting...';
        updateCounters();
        updateGameStatus();
        updateBonusValues();
        updateSidePanels();
        if (gameState.isCountingDown && !gameState.isRunning) {
          startCountdown();
        }
        checkDrawCondition();
      });

      socket.on('ballDrawn', (ballData) => {
        if (!displayState.isCashierConnected) {
          showNotification('Cannot draw ball: Cashier not connected', 'warning');
          return;
        }
        if (gameState.isRunning && ballData && typeof ballData.number === 'number' && gameState.drawnBalls.length < 30) {
          gameState.drawnBalls.push(ballData.number);
          gameState.availableBalls = gameState.availableBalls.filter(b => b !== ballData.number);
          displayBall(ballData.number, false);
          updateCounters();
          updateSidePanels();
          checkDrawCondition();
        }
      });

      socket.on('bonusBall', (bonusBall) => {
        if (!displayState.isCashierConnected) {
          showNotification('Cannot display bonus ball: Cashier not connected', 'warning');
          return;
        }
        if (gameState.isRunning && typeof bonusBall === 'number' && gameState.drawnBalls.length < 30) {
          gameState.bonusBall = bonusBall;
          gameState.availableBalls = gameState.availableBalls.filter(b => b !== bonusBall);
          displayBall(bonusBall, true);
          updateCounters();
          updateSidePanels();
          checkDrawCondition();
        }
      });

      socket.on('gameStarted', (data) => {
        if (!displayState.isCashierConnected) {
          showNotification('Cannot start game: Cashier not connected', 'warning');
          return;
        }
        gameState.isRunning = true;
        gameState.isCountingDown = false;
        gameState.gameId = data.gameId;
        gameState.drawStartTime = Date.now();
        gameState.drawEndTime = gameState.drawStartTime + 180000;
        gameIdElement.textContent = gameState.gameId;
        updateGameStatus();
        showNotification('Game started by cashier', 'success');
        startAutoDraw();
      });

      socket.on('playTicket', ({ gameId }) => {
        if (!displayState.isConnected || !displayState.isCashierConnected) {
          showNotification('Cannot play ticket: System not fully connected', 'warning');
          return;
        }
        if (!gameState.isCountingDown && !gameState.isRunning) {
          gameState.isCountingDown = true;
          gameState.gameId = gameId;
          gameIdElement.textContent = gameId;
          updateGameStatus();
          startCountdown();
        }
      });

      socket.on('winner', ({ player, prize }) => {
        const playerData = gameState.players.find(p => p.name === player);
        if (playerData) {
          playerData.wins += 1;
          gameState.winner = { player, prize };
          addWinnerToDisplay(playerData.slipNumber, player, prize);
          showNotification(`Winner: ${player} wins ${prize} NAD!`, 'success');
          if (displayState.soundEnabled) {
            const utterance = new SpeechSynthesisUtterance(`Winner! ${player} wins ${prize} Namibian dollars!`);
            utterance.rate = 0.8;
            utterance.pitch = 1;
            utterance.volume = 0.8;
            speechSynthesis.speak(utterance);
          }
        }
      });

      socket.on('gameReset', () => {
        gameState = {
          gameId: null,
          availableBalls: Array.from({length: 30}, (_, i) => i + 1),
          drawnBalls: [],
          bonusBall: null,
          bonusAmounts: { bronze: 705.66, silver: 792.56, gold: 1250.00 },
          gameHistory: gameState.gameHistory,
          players: [],
          winner: null,
          isRunning: false,
          isCountingDown: false,
          recentBalls: [],
          lastUpdate: Date.now(),
          drawStartTime: null,
          drawEndTime: null
        };
        
        currentBall.classList.remove('active', 'bonus');
        ballLetter.classList.remove('active');
        ballNumber.textContent = '';
        ballLetter.textContent = '';
        callDisplay.textContent = 'Waiting for cashier to start game...';
        winnersList.innerHTML = '';
        drawScreen.classList.remove('active');
        jackpotScreen.classList.remove('active');
        floatingBalls.style.opacity = '0';
        
        countdownContainer.style.opacity = '0';
        countdownContainer.style.pointerEvents = 'none';
        countdownNumber.textContent = '';
        
        updateCounters();
        updateSidePanels();
        updateGameStatus();
        showNotification('Game reset by cashier', 'info');
      });

      socket.on('bonusUpdate', (updates) => {
        gameState.bonusAmounts = { ...gameState.bonusAmounts, ...updates };
        updateBonusValues();
        showNotification('Bonus amounts updated', 'success');
      });

      socket.on('error', (message) => {
        showNotification(message, 'error');
      });
    }

    // Countdown Animation
    function startCountdown() {
      if (!displayState.isConnected || !displayState.isCashierConnected) {
        gameState.isCountingDown = false;
        updateGameStatus();
        return;
      }
      countdownContainer.style.opacity = '1';
      countdownContainer.style.pointerEvents = 'auto';
      callDisplay.textContent = 'Game starting...';
      let count = 10;
      
      const timeline = gsap.timeline({
        onComplete: () => {
          gameState.isCountingDown = false;
          gameState.isRunning = true;
          countdownContainer.style.opacity = '0';
          countdownContainer.style.pointerEvents = 'none';
          countdownNumber.textContent = '';
          callDisplay.textContent = 'Game started!';
          updateGameStatus();
          floatingBalls.style.opacity = '1';
          socket.emit('gameStarted', { gameId: gameState.gameId });
        }
      });

      function animateCount(number) {
        countdownNumber.textContent = number;
        timeline.to(countdownNumber, {
          scale: 1,
          opacity: 1,
          duration: 0.5,
          ease: "power2.out",
          onStart: () => {
            countdownNumber.style.opacity = '0';
            countdownNumber.style.transform = 'scale(0.5)';
            if (displayState.soundEnabled) {
              const utterance = new SpeechSynthesisUtterance(number.toString());
              utterance.rate = 0.8;
              utterance.pitch = 1;
              utterance.volume = 0.8;
              speechSynthesis.speak(utterance);
            }
          },
          onComplete: () => {
            gsap.to(countdownNumber, { opacity: 0, duration: 0.3, ease: "power2.in" });
          }
        }, `+=0.5`);
      }

      for (let i = count; i >= 1; i--) {
        animateCount(i);
      }
    }

    // Ball mappings
    function getBallLetter(number) {
      if (number >= 1 && number <= 6) return 'A';
      if (number <= 12) return 'B';
      if (number <= 18) return 'C';
      if (number <= 24) return 'D';
      if (number <= 30) return 'E';
      return '';
    }

    function getBallColor(number) {
      const colors = ['#fbbf24', '#3b82f6', '#dc2626', '#7c3aed', '#ea580c'];
      return colors[(number - 1) % colors.length];
    }

    function getBallCall(letter, number) {
      const calls = {
        'A': ['Golden Start', 'Blue Moon', 'Red Dawn', 'Purple Haze', 'Orange Crush', 'Green Light'],
        'B': ['Lucky Seven', 'Black Magic', 'Yellow Stripe', 'Blue Streak', 'Red Flash', 'Purple Pulse'],
        'C': ['Orange Twist', 'Green Wave', 'Maroon Mark', 'Yellow Glow', 'Blue Burst', 'Red Spark'],
        'D': ['Purple Dream', 'Orange Blaze', 'Green Rush', 'Maroon Mist', 'Black Shadow', 'Yellow Beam'],
        'E': ['Blue Tide', 'Red Flame', 'Purple Star', 'Orange Flare', 'Green Spark', 'Maroon Glow']
      };
      return calls[letter]?.[(number - 1) % 6] || 'Lucky Number';
    }

    function displayBall(number, isBonus = false) {
      if (!number || isNaN(number)) return;
      const letter = getBallLetter(number);
      const color = getBallColor(number);
      const call = getBallCall(letter, number);
      
      ballNumber.textContent = number;
      ballLetter.textContent = letter;
      callDisplay.textContent = `${letter}-${number}, ${call}`;
      
      currentBall.style.background = color;
      currentBall.classList.toggle('bonus', isBonus);
      currentBall.classList.add('active');
      ballLetter.classList.add('active');
      
      if (displayState.soundEnabled) playBallSound(letter, number);
      
      addToRecentBalls(number, letter, color, isBonus);
      updateSidePanels();
    }

    function playBallSound(letter, number) {
      if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(`${letter} ${number}`);
        utterance.rate = 0.8;
        utterance.pitch = 1;
        utterance.volume = 0.8;
        speechSynthesis.speak(utterance);
      }
    }

    function addToRecentBalls(number, letter, color, isBonus) {
      gameState.recentBalls.unshift({ number, letter, color, isBonus });
      if (gameState.recentBalls.length > 10) gameState.recentBalls.pop();
      updateRecentBallsDisplay();
    }

    function updateRecentBallsDisplay() {
      recentBalls.innerHTML = '';
      gameState.recentBalls.slice(0, 5).forEach((ball, index) => {
        const ballElement = document.createElement('div');
        ballElement.className = `recent-ball${ball.isBonus ? ' bonus' : ''}`;
        ballElement.textContent = ball.number;
        ballElement.style.background = ball.color;
        ballElement.style.animationDelay = `${index * 0.1}s`;
        recentBalls.appendChild(ballElement);
        setTimeout(() => ballElement.classList.add('active'), index * 100);
      });
    }

    function addWinnerToDisplay(slipNumber, player, prize) {
      const winnerElement = document.createElement('div');
      winnerElement.className = 'winner-item';
      winnerElement.textContent = `Slip: ${slipNumber} | ${player} wins ${prize} NAD`;
      winnersList.prepend(winnerElement);
      if (winnersList.children.length > 5) winnersList.removeChild(winnersList.lastChild);
    }

    function updateSidePanels() {
      leftBalls.innerHTML = '';
      gameState.drawnBalls.slice(-30).forEach(number => {
        const letter = getBallLetter(number);
        const color = getBallColor(number);
        const isBonus = number === gameState.bonusBall;
        const ballElement = document.createElement('div');
        ballElement.className = `ball-item${isBonus ? ' bonus' : ''}`;
        ballElement.textContent = number;
        ballElement.style.background = color;
        leftBalls.appendChild(ballElement);
      });
      
      rightBalls.innerHTML = '';
      gameState.recentBalls.slice(0, 12).forEach(ball => {
        const ballElement = document.createElement('div');
        ballElement.className = `ball-item${ball.isBonus ? ' bonus' : ''}`;
        ballElement.textContent = ball.number;
        ballElement.style.background = ball.color;
        rightBalls.appendChild(ballElement);
      });
    }

    function updateCounters() {
      ballsCalled.textContent = gameState.drawnBalls.length;
      ballsRemaining.textContent = gameState.availableBalls.length;
    }

    function updateGameStatus() {
      if (!displayState.isConnected) {
        statusText.innerHTML = '<span class="status-disconnected">‚óè DISCONNECTED FROM SERVER</span>';
        showWaitingAnimation();
      } else if (!displayState.isCashierConnected) {
        statusText.innerHTML = '<span class="status-waiting">‚óè WAITING FOR CASHIER TO CONNECT</span>';
        showWaitingAnimation();
      } else if (gameState.isCountingDown) {
        statusText.innerHTML = '<span class="status-countdown">‚óè COUNTDOWN</span>';
        hideWaitingAnimation();
      } else if (gameState.isRunning) {
        statusText.innerHTML = '<span class="status-live">‚óè LIVE</span>';
        hideWaitingAnimation();
      } else {
        statusText.innerHTML = '<span class="status-waiting">‚óè WAITING FOR CASHIER TO START</span>';
        showWaitingAnimation();
      }
    }

    function showWaitingAnimation() {
      waitingAnimation.classList.add('active');
      document.querySelector('.center-display').style.opacity = '0.3';
      startParticleEffects();
    }

    function hideWaitingAnimation() {
      waitingAnimation.classList.remove('active');
      document.querySelector('.center-display').style.opacity = '1';
    }

    function startBonusAnimations() {
      const bonusValues = {
        'bronze-value': { start: 500, end: gameState.bonusAmounts.bronze, duration: 3000 },
        'silver-value': { start: 600, end: gameState.bonusAmounts.silver, duration: 3500 },
        'gold-value': { start: 800, end: gameState.bonusAmounts.gold, duration: 4000 }
      };

      Object.entries(bonusValues).forEach(([id, config]) => {
        const element = document.getElementById(id);
        if (element) animateValue(element, config.start, config.end, config.duration);
      });

      const slides = ['bronze-bonus', 'silver-bonus', 'gold-bonus'];
      let currentSlide = 0;

      function animateSlides() {
        if (!waitingAnimation.classList.contains('active')) return;
        const current = document.getElementById(slides[currentSlide]);
        const prev = document.getElementById(slides[(currentSlide - 1 + slides.length) % slides.length]);
        const next = document.getElementById(slides[(currentSlide + 1) % slides.length]);

        if (prev) prev.classList.add('slide-out-left');
        if (current) {
          current.classList.remove('slide-out-left', 'slide-out-right');
          current.classList.add('slide-in');
          current.style.opacity = '1';
          current.style.transform = 'translateX(0)';
        }
        if (next) next.classList.add('slide-out-right');

        document.querySelectorAll('.slide-dot').forEach(dot => dot.classList.remove('active'));
        document.querySelector(`.slide-dot[data-slide="${currentSlide}"]`).classList.add('active');

        currentSlide = (currentSlide + 1) % slides.length;
      }

      animateSlides();
      const interval = setInterval(animateSlides, 5000);

      const sparkleInterval = setInterval(() => {
        if (waitingAnimation.classList.contains('active')) createSparkles();
      }, 1000);

      return () => {
        clearInterval(interval);
        clearInterval(sparkleInterval);
      };
    }

    function animateValue(element, start, end, duration) {
      const startTime = Date.now();
      function updateValue() {
        const elapsed = Date.now() - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const easeOutQuart = 1 - Math.pow(1 - progress, 4);
        const currentValue = start + (end - start) * easeOutQuart;
        element.textContent = `$${currentValue.toFixed(2)}`;
        if (progress < 1) requestAnimationFrame(updateValue);
        else if (waitingAnimation.classList.contains('active')) setTimeout(() => animateValue(element, start, end, duration), 2000);
      }
      requestAnimationFrame(updateValue);
    }

    function createSparkles() {
      const bonusItems = document.querySelectorAll('.bonus-item');
      bonusItems.forEach(item => {
        for (let i = 0; i < 3; i++) {
          const sparkle = document.createElement('div');
          sparkle.className = 'sparkle';
          sparkle.style.left = Math.random() * 100 + '%';
          sparkle.style.top = Math.random() * 100 + '%';
          sparkle.style.animationDelay = Math.random() * 2 + 's';
          item.appendChild(sparkle);
          setTimeout(() => sparkle.remove(), 2000);
        }
      });
    }

    function startParticleEffects() {
      const particles = document.getElementById('particles');
      function createParticle() {
        if (!waitingAnimation.classList.contains('active')) return;
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.animationDuration = (Math.random() * 8 + 6) + 's';
        particle.style.animationDelay = Math.random() * 2 + 's';
        const colors = ['#ffd700', '#c0c0c0', '#cd7f32', '#00e5ff', '#ffffff'];
        particle.style.background = colors[Math.floor(Math.random() * colors.length)];
        particles.appendChild(particle);
        setTimeout(() => particle.remove(), 10000);
      }
      const particleInterval = setInterval(() => createParticle(), 800);
      return () => clearInterval(particleInterval);
    }

    function updateBonusValues() {
      if (bronzeAmount) bronzeAmount.textContent = gameState.bonusAmounts.bronze.toFixed(2);
      if (silverAmount) silverAmount.textContent = gameState.bonusAmounts.silver.toFixed(2);
      if (bronzeValue) bronzeValue.textContent = `$${gameState.bonusAmounts.bronze.toFixed(2)}`;
      if (silverValue) silverValue.textContent = `$${gameState.bonusAmounts.silver.toFixed(2)}`;
      if (goldValue) goldValue.textContent = `$${gameState.bonusAmounts.gold.toFixed(2)}`;
      if (jackpotBronze) jackpotBronze.textContent = `$${gameState.bonusAmounts.bronze.toFixed(2)}`;
      if (jackpotSilver) jackpotSilver.textContent = `$${gameState.bonusAmounts.silver.toFixed(2)}`;
      if (jackpotGold) jackpotGold.textContent = `$${gameState.bonusAmounts.gold.toFixed(2)}`;
    }

    function syncWithCashier() {
      socket.emit('requestGameState');
      showNotification('Syncing with cashier...', 'info');
    }

    function toggleSound() {
      displayState.soundEnabled = !displayState.soundEnabled;
      toggleSoundBtn.textContent = displayState.soundEnabled ? 'SOUND ON' : 'SOUND OFF';
      toggleSoundBtn.style.background = displayState.soundEnabled ? 
        'linear-gradient(135deg, #4caf50 0%, #2e7d32 100%)' : 
        'linear-gradient(135deg, #f44336 0%, #c62828 100%)';
      showNotification(displayState.soundEnabled ? 'Sound enabled' : 'Sound disabled', 'success');
    }

    function toggleFullscreen() {
      if (!displayState.isFullscreen) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    }

    function showNotification(message, type) {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'success' ? '#4caf50' : type === 'error' ? '#f44336' : type === 'warning' ? '#ff9800' : '#2196f3'};
        color: white;
        padding: 12px 24px;
        border-radius: 8px;
        font-weight: 700;
        z-index: 1000;
        opacity: 0;
        transform: translateX(100px);
        transition: all 0.3s ease;
        white-space: pre-wrap;
      `;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.opacity = '1';
        notification.style.transform = 'translateX(0)';
      }, 100);
      
      setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100px)';
        setTimeout(() => notification.remove(), 300);
      }, 5000);
    }

    function startAutoDraw() {
      if (!gameState.isRunning || gameState.drawnBalls.length >= 30) return;
      
      const intervalTime = 5000;
      let drawTimeout;

      function drawNextBall() {
        if (!gameState.isRunning || gameState.drawnBalls.length >= 30) {
          gameState.isRunning = false;
          updateGameStatus();
          checkDrawCondition();
          return;
        }

        const available = gameState.availableBalls;
        if (available.length > 0) {
          const randomIndex = Math.floor(Math.random() * available.length);
          const ballNumber = available[randomIndex];
          socket.emit('drawBall', { number: ballNumber });
        }

        drawTimeout = setTimeout(drawNextBall, intervalTime);
      }

      drawTimeout = setTimeout(drawNextBall, intervalTime);

      return () => clearTimeout(drawTimeout);
    }

    function checkDrawCondition() {
      if (gameState.drawnBalls.length >= 30 || (gameState.drawEndTime && Date.now() >= gameState.drawEndTime)) {
        gameState.isRunning = false;
        updateGameStatus();
        showDrawScreen();
        // Reset to a new game state locally and request sync
        gameState = {
          gameId: null,
          availableBalls: Array.from({length: 30}, (_, i) => i + 1),
          drawnBalls: [],
          bonusBall: null,
          bonusAmounts: { bronze: 705.66, silver: 792.56, gold: 1250.00 },
          gameHistory: gameState.gameHistory,
          players: [],
          winner: null,
          isRunning: false,
          isCountingDown: false,
          recentBalls: [],
          lastUpdate: Date.now(),
          drawStartTime: null,
          drawEndTime: null
        };
        gameIdElement.textContent = 'Waiting...';
        socket.emit('requestGameState');
      }
    }

    function showDrawScreen() {
      drawScreen.classList.add('active');
      drawnBallsList.innerHTML = '';
      undrawnBallsList.innerHTML = '';
      
      gameState.drawnBalls.forEach(number => {
        const ballElement = document.createElement('div');
        ballElement.className = 'draw-ball';
        ballElement.textContent = number;
        ballElement.style.background = getBallColor(number);
        drawnBallsList.appendChild(ballElement);
      });

      gameState.availableBalls.forEach(number => {
        const ballElement = document.createElement('div');
        ballElement.className = 'draw-ball';
        ballElement.textContent = number;
        ballElement.style.background = getBallColor(number);
        undrawnBallsList.appendChild(ballElement);
      });

      winnerDisplay.textContent = gameState.winner ? `${gameState.winner.player} wins ${gameState.winner.prize} NAD!` : 'No winner this round.';
      setTimeout(() => {
        showJackpotScreen();
        // No need to request reset here as checkDrawCondition handles it
      }, 5000);
    }

    function showJackpotScreen() {
      jackpotScreen.classList.add('active');
      setTimeout(() => jackpotScreen.classList.remove('active'), 10000);
    }

    // Event Listeners
    syncGameBtn.addEventListener('click', syncWithCashier);
    toggleSoundBtn.addEventListener('click', toggleSound);
    fullscreenBtn.addEventListener('click', toggleFullscreen);
    document.addEventListener('fullscreenchange', () => {
      displayState.isFullscreen = !!document.fullscreenElement;
      fullscreenBtn.textContent = displayState.isFullscreen ? 'EXIT FULLSCREEN' : 'FULLSCREEN';
    });

    // Initialize
    initSocket();
    updateGameStatus();
    updateBonusValues();
    waitingAnimation.cleanupBonusAnimations = startBonusAnimations();
    startParticleEffects();

    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
      if (socket) socket.disconnect();
      if (waitingAnimation.cleanupBonusAnimations) waitingAnimation.cleanupBonusAnimations();
    });
  </script>
</body>
</html>