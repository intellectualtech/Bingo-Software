<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lucky Six Bingo</title>
  <style>
    /* Global resets and basic styles */
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Times New Roman', serif;
      background: #00207a; /* dark blue base */
      background-image: radial-gradient(circle at center, #00369b 0%, #001a4e 100%);
      overflow-x: hidden;
      color: #0d47a1;
      user-select: none;
    }

    /* Container for entire screen */
    .container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      background: #002783 url("https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e581b58f-d7d3-4009-90a6-a9c868c9d25f.png") no-repeat center center;
      background-size: cover;
      border: 2px solid #001a4e;
      box-shadow: 0 0 15px #001a4e inset;
    }

    /* Top Blue header bar */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(90deg, #030a65 0%, #001a4e 100%);
      border-bottom: 2px solid #3237af;
      height: 48px;
      padding: 0 15px;
      user-select: text;
      flex-shrink: 0;
    }

    /* Title */
    header h1 {
      font-family: Georgia, serif;
      font-size: clamp(18px, 4vw, 28px);
      color: white;
      text-shadow: 2px 2px 3px #000c33;
      margin: 0;
      flex: 1;
      font-weight: normal;
      letter-spacing: 0.05em;
    }

    /* Color betting dots container */
    .color-betting {
      display: flex;
      gap: clamp(6px, 1.5vw, 12px);
      align-items: center;
      font-size: clamp(10px, 2vw, 13px);
      font-weight: 600;
      color: white;
      font-family: Arial, Helvetica, sans-serif;
      white-space: nowrap;
    }

    .color-betting span {
      margin-right: clamp(5px, 1vw, 10px);
      font-size: clamp(10px, 2vw, 13px);
      font-weight: normal;
      color: white;
      text-shadow: 1px 1px 3px #000;
    }

    .color-dot {
      width: clamp(16px, 3vw, 20px);
      height: clamp(16px, 3vw, 20px);
      border-radius: 50%;
      border: 1.5px solid #555;
      box-shadow:
        inset 0 -2px 6px rgba(255, 255, 255, 0.6),
        0 2px 3px rgba(0,0,0,0.8);
      cursor: default;
      flex-shrink: 0;
    }

    /* Colored circles from left to right */
    .color-purple { background: radial-gradient(circle at 30% 30%, #845ec2, #4b216d); }
    .color-yellow { background: radial-gradient(circle at 30% 30%, #f4d35e, #a38621); }
    .color-gray { background: radial-gradient(circle at 30% 30%, #a1a1a1, #5f5f5f); }
    .color-brown { background: radial-gradient(circle at 30% 30%, #8b5e3c, #3e2715); }
    .color-green { background: radial-gradient(circle at 30% 30%, #3a8d44, #115214); }
    .color-red { background: radial-gradient(circle at 30% 30%, #bb3d3d, #6b1f1f); }
    .color-blue { background: radial-gradient(circle at 30% 30%, #3b82f6, #1e40af); }
    .color-orange { background: radial-gradient(circle at 30% 30%, #ea580c, #a15c1b); }
    .color-maroon { background: radial-gradient(circle at 30% 30%, #7f1d1d, #3e2715); }
    .color-black { background: radial-gradient(circle at 30% 30%, #1f2937, #000); }

    /* Main content layout */
    .game-layout {
      flex: 1;
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      grid-template-rows: auto 1fr auto;
      gap: clamp(10px, 2vw, 20px);
      padding: clamp(10px, 2vw, 20px);
      min-height: 0;
    }

    /* Drawn/Undrawn balls section */
    .balls-status {
      display: none;
      flex-direction: column;
      gap: 20px;
      padding: 20px;
      background: rgba(0, 0, 0, 0.5);
      border-top: 2px solid #001a4e;
      color: white;
      font-family: Arial, sans-serif;
    }

    .balls-status.show {
      display: flex;
    }

    .balls-status h2 {
      margin: 0;
      font-size: clamp(16px, 3vw, 20px);
      text-align: center;
      text-shadow: 1px 1px 2px #000;
    }

    .drawn-balls-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
      gap: 10px;
      justify-items: center;
    }

    .undrawn-balls-list {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    .ball-display {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 14px;
      font-weight: bold;
      color: white;
      text-shadow: 0 0 3px #000;
      border: 1px solid #333;
      box-shadow: inset 0 2px 3px rgba(255,255,255,0.5), 0 2px 3px rgba(0,0,0,0.5);
    }

    .undrawn-ball {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #555;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 14px;
      font-weight: bold;
      color: #ddd;
      text-shadow: 0 0 3px #000;
      border: 1px solid #333;
    }

    /* Top row - Round box and Jackpot */
    .top-left {
      grid-column: 1;
      grid-row: 1;
      display: flex;
      justify-content: flex-start;
      align-items: flex-start;
    }

    .top-right {
      grid-column: 3;
      grid-row: 1;
      display: flex;
      justify-content: flex-end;
      align-items: flex-start;
    }

    /* Middle row - Points and Wheel */
    .middle-left {
      grid-column: 1;
      grid-row: 2;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      justify-content: space-between;
      min-height: 0;
    }

    .middle-center {
      grid-column: 2;
      grid-row: 2;
      display: flex;
      justify-content: flex-start;
      align-items: flex-start;
    }

    .middle-right {
      grid-column: 3;
      grid-row: 2;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      justify-content: space-between;
      min-height: 0;
    }

    /* Bottom row - Center columns */
    .bottom-center {
      grid-column: 1 / -1;
      grid-row: 3;
      display: flex;
      justify-content: center;
      gap: clamp(90px, 12vw, 120px);
      margin-top: -315px;
    }

    /* Round number box style */
    .round-box {
      background: linear-gradient(45deg, #d1d1d1 20%, #969696 50%, #e4e4e4 80%);
      border: 1.8px solid #444;
      border-radius: 14px;
      padding: clamp(6px, 1.5vw, 8px) clamp(15px, 3vw, 20px);
      width: clamp(80px, 15vw, 120px);
      box-shadow: inset 0 3px 10px #fff8, 0 0 6px #0008;
      font-size: clamp(14px, 3vw, 18px);
      text-align: center;
      font-family: serif;
      color: #222;
      user-select: text;
    }

    .round-box small {
      display: block;
      font-size: clamp(9px, 2vw, 11px);
      color: #3a3a3a;
      margin-bottom: 2px;
      font-weight: 600;
    }

    .round-box .round-number {
      font-size: clamp(20px, 4vw, 28px);
      font-weight: 700;
      font-family: 'Georgia', serif;
      text-shadow: 1px 1px 0 #ccc;
    }

    /* Jackpot code box style */
    .jackpot-box {
      background: linear-gradient(45deg, #d1d1d1 15%, #a4a4a4 50%, #eee 85%);
      border: 1.8px solid #444;
      border-radius: 14px;
      padding: clamp(6px, 1.5vw, 8px) clamp(15px, 3vw, 20px);
      width: clamp(80px, 15vw, 120px);
      text-align: center;
      font-family: 'Georgia', serif;
      font-size: clamp(18px, 4vw, 24px);
      font-weight: 700;
      user-select: text;
      color: #111;
      box-shadow: inset 0 3px 8px #fff9, 0 0 5px #0007;
    }

    .jackpot-box small {
      display: block;
      font-size: clamp(9px, 2vw, 11px);
      color: #4d4d4d;
      margin-bottom: 2px;
      font-weight: 600;
      user-select: text;
    }

    /* Points list styling */
    .points-list {
      display: flex;
      flex-direction: column;
      gap: clamp(6px, 1.5vw, 8px);
      font-family: 'Times New Roman', serif;
      font-size: clamp(16px, 3vw, 20px);
      font-weight: 600;
      color: #0d47a1;
      user-select: none;
    }

    .points-list label {
      cursor: default;
      display: flex;
      align-items: center;
      gap: clamp(6px, 2vw, 10px);
      user-select: none;
    }

    .points-right label {
      justify-content: flex-end;
    }

    .black-circle {
      width: clamp(50px, 8vw, 70px);
      height: clamp(50px, 8vw, 70px);
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #111 0%, #3a3a3a 60%);
      box-shadow:
        inset 0 2px 3px #0009,
        0 2px 4px #000c;
      border: clamp(4px, 1vw, 6.5px) solid #000;
      flex-shrink: 0;
    }

    /* Blue star selected circles */
    .blue-star-selected {
      position: relative;
      width: clamp(50px, 8vw, 70px);
      height: clamp(50px, 8vw, 70px);
      border-radius: 50%;
      background: #0d47a1;
      border: 2px solid #3572e2;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 0 6px #2c59c1;
      flex-shrink: 0;
    }

    .blue-star-selected::after {
      content: "â˜…";
      font-size: clamp(14px, 3vw, 18px);
      color: #bdd7ff;
      text-shadow: 0 0 5px #4281f5;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      font-weight: 900;
    }

    .blue-star-selected + span {
      color: white;
    }

    /* Style for drawn balls in points circles */
    .drawn-ball {
      position: relative;
      width: clamp(50px, 8vw, 70px);
      height: clamp(50px, 8vw, 70px);
      border-radius: 50%;
      border: 1.6px solid #222;
      box-shadow:
        inset 0 2px 3px #fff9,
        0 2px 7px #0008;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-shrink: 0;
    }

    .drawn-ball::after {
      content: attr(data-number);
      font-size: clamp(12px, 2.5vw, 16px);
      color: white;
      text-shadow: 0 0 4px #000;
      font-weight: 700;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    /* Main wheel center container */
    .center-wheel-container {
      position: relative;
      width: clamp(250px, 40vw, 320px);
      height: clamp(250px, 40vw, 320px);
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
      filter: drop-shadow(0 0 7px #0009);
    }

    /* Outer circle */
    .wheel-outer {
      position: relative;
      width: 100%;
      height: 100%;
      background:
        radial-gradient(circle at center, #e8e8e8 30%, #c0c0c0 45%, #9a9a9a 65%, #d5d5d5 85%);
      border-radius: 50%;
      box-shadow:
        inset 0 8px 16px rgba(255, 255, 255, 0.8),
        inset 0 -8px 16px rgba(0, 0, 0, 0.3),
        0 4px 20px rgba(0, 0, 0, 0.4);
      border: clamp(3px, 0.6vw, 5px) solid #888;
      overflow: visible;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Inner mirror black circle */
    .wheel-inner-black {
      position: absolute;
      width: 65%;
      height: 65%;
      background: radial-gradient(circle at 110px 50px, #1d1d1d 20%, #000000 88%);
      border-radius: 50%;
      box-shadow:
        inset 0 0 19px 4px #333,
        inset -4px -2px 19px 2px #555;
      border: 1.8px solid #555;
      z-index: 5;
      overflow: hidden;
      position: relative;
    }

    /* Reflection highlight on inner black glass */
    .reflection {
      position: absolute;
      top: 20%;
      right: 25%;
      width: 30%;
      height: 30%;
      background: radial-gradient(ellipse at top right, #fff9 0%, transparent 90%);
      border-radius: 45% 65% 45% 55% / 30% 60% 30% 45%;
      filter: blur(2px);
      pointer-events: none;
      z-index: 11;
    }

    /* Shaking balls inside wheel */
    .shaking-ball {
      position: absolute;
      width: clamp(24px, 4vw, 30px);
      height: clamp(24px, 4vw, 30px);
      border-radius: 50%;
      border: 1.6px solid #222;
      box-shadow:
        inset 0 2px 3px #fff9,
        0 2px 7px #0008;
      filter: drop-shadow(0 1px 2px #111);
      z-index: 10;
      animation: shake 0.5s infinite alternate;
    }

    @keyframes shake {
      0% { transform: translate(0, 0) rotate(0deg); }
      100% { transform: translate(calc(10px * var(--dx)), calc(10px * var(--dy))) rotate(2deg); }
    }

    /* Pop-up ball animation */
    .pop-up-ball {
      position: absolute;
      border-radius: 50%;
      border: 2px solid #333;
      box-shadow:
        inset 0 4px 8px rgba(255, 255, 255, 0.5),
        inset -4px -4px 8px rgba(0, 0, 0, 0.4),
        0 4px 12px rgba(0, 0, 0, 0.6);
      z-index: 12;
      display: flex;
      justify-content: center;
      align-items: center;
      transform-origin: center center;
      animation: popUpAndCover 2.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    .pop-up-ball::before {
      content: '';
      position: absolute;
      width: 40%;
      height: 40%;
      top: 15%;
      left: 15%;
      background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.8) 0%, transparent 70%);
      border-radius: 50%;
      filter: blur(2px);
      z-index: 13;
    }

    .pop-up-ball::after {
      content: attr(data-number);
      font-size: clamp(24px, 5vw, 32px);
      font-family: 'Arial', sans-serif;
      color: #fff;
      text-shadow: 0 0 5px #000, 0 0 10px #0005;
      font-weight: 900;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%) scale(1);
      z-index: 14;
      animation: numberScale 2.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    @keyframes popUpAndCover {
      0% {
        width: clamp(24px, 4vw, 30px);
        height: clamp(24px, 4vw, 30px);
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0.5) rotate(0deg);
        opacity: 0;
      }
      20% {
        width: clamp(24px, 4vw, 30px);
        height: clamp(24px, 4vw, 30px);
        transform: translate(-50%, -50%) scale(1.2) rotate(10deg);
        opacity: 1;
      }
      60% {
        width: clamp(250px, 40vw, 320px);
        height: clamp(250px, 40vw, 320px);
        transform: translate(-50%, -50%) scale(1.1) rotate(-5deg);
        opacity: 0.95;
      }
      100% {
        width: clamp(250px, 40vw, 320px);
        height: clamp(250px, 40vw, 320px);
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
        opacity: 0;
      }
    }

    @keyframes numberScale {
      0% {
        font-size: clamp(12px, 2.5vw, 16px);
        transform: translate(-50%, -50%) scale(0.5);
        opacity: 0;
      }
      20% {
        font-size: clamp(24px, 5vw, 32px);
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
      60% {
        font-size: clamp(48px, 10vw, 64px);
        transform: translate(-50%, -50%) scale(1.1);
        opacity: 0.95;
      }
      100% {
        font-size: clamp(48px, 10vw, 64px);
        transform: translate(-50%, -50%) scale(1);
        opacity: 0;
      }
    }

    /* Bottom half circle inside */
    .wheel-inner-bottom {
      position: absolute;
      width: 60%;
      height: 32%;
      background: linear-gradient(to top, #0a2a63 0%, #1951a7 70%, #3c6feb 100%);
      border-radius: 0 0 100% 100% / 0 0 100% 100%;
      bottom: 6%;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: inset 0 15px 40px #163f9111;
      border-top: 2px solid #3864b0;
      z-index: 6;
    }

    /* Silver curved holder/track for the 4 recent balls */
    .holder-ring {
      position: absolute;
      width: 130%;
      height: 120%;
      top: -7.5%;
      left: -10.5%;
      z-index: -1;
      pointer-events: none;
    }

    .holder-ring::before {
      content: '';
      position: absolute;
      width: 25%;
      height: 85%;
      right: -5%;
      top: 7.5%;
      background: linear-gradient(45deg, #e8e8e8 20%, #c0c0c0 40%, #a8a8a8 60%, #d0d0d0 80%);
      border-radius: 50px;
      border: 2px solid #999;
      box-shadow:
        inset 2px 2px 8px rgba(255, 255, 255, 0.7),
        inset -2px -2px 8px rgba(0, 0, 0, 0.3),
        0 2px 6px rgba(0, 0, 0, 0.4);
      z-index: 1;
    }

    .holder-ring .recent-ball {
      position: absolute;
      width: clamp(50px, 8vw, 70px);
      height: clamp(50px, 8vw, 70px);
      border-radius: 50%;
      border: 2px solid #333;
      box-shadow:
        inset 0 2px 4px rgba(255, 255, 255, 0.5),
        0 2px 8px rgba(0,0,0,0.6);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2;
    }

    .recent-ball::after {
      content: attr(data-number);
      font-size: clamp(16px, 3.5vw, 20px);
      color: white;
      text-shadow: 0 0 4px #000;
      font-weight: 700;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .holder-ring .recent-ball:nth-child(1) { top: 5%; right: 2%; }
    .holder-ring .recent-ball:nth-child(2) { top: 30%; right: -2%; }
    .holder-ring .recent-ball:nth-child(3) { top: 55%; right: -2%; }
    .holder-ring .recent-ball:nth-child(4) { top: 80%; right: 2%; }

    /* Bottom center columns */
    .points-column {
      display: flex;
      flex-direction: column;
      gap: clamp(10px, 2vw, 14px);
      font-family: 'Times New Roman', serif;
      font-weight: 600;
      font-size: clamp(14px, 3vw, 18px);
      color: #0d47a1;
    }

    .points-column label {
      display: flex;
      align-items: center;
      gap: clamp(6px, 1.5vw, 8px);
      cursor: default;
    }

    .points-list label span,
    .points-column label span {
      user-select: none;
      font-size: inherit;
    }

    /* Bottom overlay bar */
    footer {
      width: 100%;
      height: clamp(28px, 5vw, 32px);
      background: linear-gradient(90deg, #001e58, #00327a);
      text-align: center;
      font-family: Arial, Helvetica, sans-serif;
      font-size: clamp(11px, 2.5vw, 14px);
      color: #4972cc;
      line-height: clamp(28px, 5vw, 32px);
      border-top: 2px solid #001067;
      user-select: none;
      display: flex;
      justify-content: space-between;
      padding: 0 clamp(15px, 3vw, 26px);
      box-sizing: border-box;
      font-weight: 600;
      flex-shrink: 0;
    }

    footer div {
      text-shadow: 0 0 4px #2a3f93;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .game-layout {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto auto auto;
        gap: 15px;
      }

      .top-left, .top-right {
        grid-column: 1;
        justify-content: center;
      }

      .top-right { grid-row: 2; }
      .middle-left, .middle-right {
        grid-column: 1;
        grid-row: 4;
        flex-direction: row;
        justify-content: space-around;
        align-items: flex-start;
      }

      .middle-center { grid-column: 1; grid-row: 3; }
      .bottom-center { grid-column: 1; grid-row: 5; flex-wrap: wrap; justify-content: center; }
      .points-list { flex-direction: row; flex-wrap: wrap; justify-content: center; max-width: 300px; }
    }

    @media (max-width: 480px) {
      .color-betting { flex-wrap: wrap; gap: 8px; }
      .bottom-center { gap: 15px; }
      .points-column { gap: 8px; }
      .drawn-balls-grid { grid-template-columns: repeat(auto-fill, minmax(30px, 1fr)); }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Lucky Six Bingo</h1>
      <div class="color-betting" title="Color Betting" id="color-betting-bar">
        <span>Color Betting</span>
      </div>
    </header>

    <div class="game-layout">
      <!-- Top row -->
      <div class="top-left">
        <div class="round-box" aria-label="Round number">
          <small>Round No.</small>
          <span class="round-number" id="game-id-display">178</span>
        </div>
      </div>

      <div class="top-right">
        <div class="jackpot-box" aria-label="Jackpot code">
          <small>Jackpot code</small>
          <span>QWXS</span>
        </div>
      </div>

      <!-- Middle row -->
      <div class="middle-left">
        <div class="points-list points-left" aria-label="Left points">
          <label><span class="black-circle" data-points="10000"></span>10.000</label>
          <label><span class="black-circle" data-points="7500"></span>7.500</label>
          <label><span class="black-circle" data-points="5000"></span>5.000</label>
          <label><span class="black-circle" data-points="2500"></span>2.500</label>
          <label><span class="black-circle" data-points="1000"></span>1.000</label>
          <label><span class="black-circle" data-points="500"></span>500</label>
          <label><span class="black-circle" data-points="300"></span>300</label>
          <label><span class="black-circle" data-points="200"></span>200</label>
          <label><span class="blue-star-selected" data-points="150"></span>150</label>
        </div>
      </div>

      <div class="middle-center">
        <div class="center-wheel-container" aria-label="Center bingo wheel with balls">
          <div class="wheel-outer" role="img" aria-label="Silver metallic bingo cage">
            <div class="wheel-inner-black" aria-hidden="true">
              <div class="reflection"></div>
              <div class="shaking-ball color-yellow" id="shaking-ball-1" aria-label="Yellow shaking ball"></div>
              <div class="shaking-ball color-blue" id="shaking-ball-2" aria-label="Blue shaking ball"></div>
              <div class="shaking-ball color-red" id="shaking-ball-3" aria-label="Red shaking ball"></div>
              <div class="shaking-ball color-purple" id="shaking-ball-4" aria-label="Purple shaking ball"></div>
              <div class="shaking-ball color-orange" id="shaking-ball-5" aria-label="Orange shaking ball"></div>
              <div class="shaking-ball color-green" id="shaking-ball-6" aria-label="Green shaking ball"></div>
              <div class="shaking-ball color-maroon" id="shaking-ball-7" aria-label="Maroon shaking ball"></div>
            </div>
            <div class="wheel-inner-bottom"></div>
          </div>
          <div class="holder-ring" aria-hidden="true">
            <div class="recent-ball"></div>
            <div class="recent-ball"></div>
            <div class="recent-ball"></div>
            <div class="recent-ball"></div>
          </div>
        </div>
      </div>

      <div class="middle-right">
        <div class="points-list points-right" aria-label="Right points">
          <label><span class="black-circle" data-points="9"></span>9</label>
          <label><span class="black-circle" data-points="8"></span>8</label>
          <label><span class="black-circle" data-points="7"></span>7</label>
          <label><span class="black-circle" data-points="6"></span>6</label>
          <label><span class="black-circle" data-points="5"></span>5</label>
          <label><span class="black-circle" data-points="4"></span>4</label>
          <label><span class="blue-star-selected" data-points="3"></span>3</label>
          <label><span class="black-circle" data-points="2"></span>2</label>
          <label><span class="black-circle" data-points="1"></span>1</label>
        </div>
      </div>

      <!-- Bottom row -->
      <div class="bottom-center" aria-label="Bottom center point columns">
        <div class="points-column" aria-label="Points column 1">
          <label><span class="black-circle" data-points="100"></span>100</label>
          <label><span class="black-circle" data-points="90"></span>90</label>
          <label><span class="black-circle" data-points="80"></span>80</label>
        </div>
        <div class="points-column" aria-label="Points column 2">
          <label><span class="black-circle" data-points="70"></span>70</label>
          <label><span class="black-circle" data-points="60"></span>60</label>
          <label><span class="black-circle" data-points="50"></span>50</label>
        </div>
        <div class="points-column" aria-label="Points column 3">
          <label><span class="black-circle" data-points="40"></span>40</label>
          <label><span class="black-circle" data-points="30"></span>30</label>
          <label><span class="black-circle" data-points="25"></span>25</label>
        </div>
        <div class="points-column" aria-label="Points column 4">
          <label><span class="black-circle" data-points="20"></span>20</label>
          <label><span class="black-circle" data-points="15"></span>15</label>
          <label><span class="black-circle" data-points="10"></span>10</label>
        </div>
      </div>
    </div>

    <div class="balls-status" id="balls-status">
      <div>
        <h2>Drawn Balls</h2>
        <div class="drawn-balls-grid" id="drawn-balls-grid"></div>
      </div>
      <div>
        <h2>Undrawn Balls</h2>
        <div class="undrawn-balls-list" id="undrawn-balls-list"></div>
      </div>
    </div>

    <footer>
      <div>Preballs sum (-122,5+)</div>
      <div>ODD/EVEN</div>
      <div>Bonus numbers</div>
    </footer>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
  <script>
    let gameState = {
      gameId: null,
      drawnBalls: [],
      availableBalls: Array.from({length: 48}, (_, i) => i + 1),
      isRunning: false,
      isCountingDown: false,
      bonusBall: null,
      winner: null
    };

    // DOM elements
    const roundNumber = document.getElementById('game-id-display');
    const wheelContainer = document.querySelector('.center-wheel-container');
    const pointCircles = document.querySelectorAll('.points-list label span, .points-column label span');
    const shakingBalls = document.querySelectorAll('.shaking-ball');
    const recentBalls = document.querySelectorAll('.holder-ring .recent-ball');
    const ballsStatus = document.getElementById('balls-status');
    const drawnBallsGrid = document.getElementById('drawn-balls-grid');
    const undrawnBallsList = document.getElementById('undrawn-balls-list');

    // Color mapping for balls (aligned with server and cashier)
    const colorMap = [
      { name: 'Yellow', class: 'color-yellow', css: 'background: radial-gradient(circle at 30% 30%, #f4d35e, #a38621);' },
      { name: 'Blue', class: 'color-blue', css: 'background: radial-gradient(circle at 30% 30%, #3b82f6, #1e40af);' },
      { name: 'Red', class: 'color-red', css: 'background: radial-gradient(circle at 30% 30%, #dc2626, #7f1d1d);' },
      { name: 'Purple', class: 'color-purple', css: 'background: radial-gradient(circle at 30% 30%, #845ec2, #4b216d);' },
      { name: 'Orange', class: 'color-orange', css: 'background: radial-gradient(circle at 30% 30%, #ea580c, #a15c1b);' },
      { name: 'Green', class: 'color-green', css: 'background: radial-gradient(circle at 30% 30%, #16a34a, #115214);' },
      { name: 'Maroon', class: 'color-maroon', css: 'background: radial-gradient(circle at 30% 30%, #7f1d1d, #3e2715);' },
      { name: 'Black', class: 'color-black', css: 'background: radial-gradient(circle at 30% 30%, #1f2937, #000);' }
    ];

    // Assign colors to balls based on number (1-48)
    function getBallColor(number) {
      return colorMap[(number - 1) % colorMap.length];
    }

    // Points mapping to match drawn balls to circles
    const pointsOrder = [
      10000, 7500, 5000, 2500, 1000, 500, 300, 200, 150, // Left column
      100, 90, 80, // Bottom column 1
      70, 60, 50, // Bottom column 2
      40, 30, 25, // Bottom column 3
      20, 15, 10, // Bottom column 4
      9, 8, 7, 6, 5, 4, 3, 2, 1 // Right column
    ];

    // Update recent balls in holder ring
    function updateRecentBalls() {
      const recent = gameState.drawnBalls.slice(-4).reverse(); // Get last 4 balls, reverse for newest at top
      recentBalls.forEach((ball, index) => {
        if (index < recent.length && recent[index]) {
          const number = recent[index];
          const color = getBallColor(number);
          ball.className = `recent-ball ${color.class}`;
          ball.style = color.css;
          ball.setAttribute('data-number', number);
          ball.setAttribute('aria-label', `${color.name} ball number ${number}`);
        } else {
          ball.className = 'recent-ball';
          ball.style = 'background: radial-gradient(circle at 30% 30%, #666, #111);';
          ball.removeAttribute('data-number');
          ball.setAttribute('aria-label', 'Empty recent ball slot');
        }
      });
    }

    // Render drawn and undrawn balls
    function renderBallsStatus() {
      // Show/hide balls status section
      ballsStatus.classList.toggle('show', gameState.drawnBalls.length >= 30);

      if (gameState.drawnBalls.length < 30) {
        drawnBallsGrid.innerHTML = '';
        undrawnBallsList.innerHTML = '';
        return;
      }

      // Render drawn balls
      drawnBallsGrid.innerHTML = '';
      gameState.drawnBalls.forEach(number => {
        const color = getBallColor(number);
        const ball = document.createElement('div');
        ball.className = `ball-display ${color.class}`;
        ball.style = color.css;
        ball.textContent = number;
        ball.setAttribute('aria-label', `${color.name} ball number ${number}`);
        drawnBallsGrid.appendChild(ball);
      });

      // Render undrawn balls
      undrawnBallsList.innerHTML = '';
      gameState.availableBalls.forEach(number => {
        const ball = document.createElement('div');
        ball.className = 'undrawn-ball';
        ball.textContent = number;
        ball.setAttribute('aria-label', `Undrawn ball number ${number}`);
        undrawnBallsList.appendChild(ball);
      });
    }

    // Random shaking animation for balls
    function updateShakingBalls() {
      if (gameState.isRunning && !gameState.isCountingDown) {
        shakingBalls.forEach(ball => {
          const radius = 0.8 * (0.65 * clamp(250, window.innerWidth * 0.4, 320) / 2);
          const angle = Math.random() * 2 * Math.PI;
          const offset = Math.random() * 10;
          const dx = (radius + offset) * Math.cos(angle);
          const dy = (radius + offset) * Math.sin(angle);
          ball.style.setProperty('--dx', dx / 10);
          ball.style.setProperty('--dy', dy / 10);
        });
      }
    }

    // Helper function to mimic clamp in JavaScript
    function clamp(min, val, max) {
      return Math.min(Math.max(val, min), max);
    }

    // Start shaking animation
    let shakeInterval;
    function startShaking() {
      if (!shakeInterval) {
        shakeInterval = setInterval(updateShakingBalls, 500);
      }
    }

    // Stop shaking animation
    function stopShaking() {
      if (shakeInterval) {
        clearInterval(shakeInterval);
        shakeInterval = null;
        shakingBalls.forEach(ball => {
          ball.style.setProperty('--dx', 0);
          ball.style.setProperty('--dy', 0);
        });
      }
    }

    // Create and animate a pop-up ball
    function animateBall(number) {
      return new Promise(resolve => {
        stopShaking();
        const color = getBallColor(number);
        const selectedBallIndex = Math.floor(Math.random() * shakingBalls.length);
        const selectedBall = shakingBalls[selectedBallIndex];
        selectedBall.className = `pop-up-ball ${color.class}`;
        selectedBall.style = color.css;
        selectedBall.setAttribute('data-number', number);
        selectedBall.setAttribute('aria-label', `${color.name} ball number ${number}`);

        selectedBall.addEventListener('animationend', () => {
          selectedBall.className = `shaking-ball ${color.class}`;
          selectedBall.style = color.css;
          selectedBall.removeAttribute('data-number');
          selectedBall.setAttribute('aria-label', `${color.name} shaking ball`);
          startShaking();
          resolve();
        }, { once: true });
      });
    }

    // Update points circles with drawn balls
    function updatePointsCircles() {
      pointCircles.forEach((circle, index) => {
        const points = parseInt(circle.getAttribute('data-points'));
        const ballIndex = pointsOrder.indexOf(points);
        if (ballIndex < gameState.drawnBalls.length && gameState.drawnBalls[ballIndex] !== undefined) {
          const ballNumber = gameState.drawnBalls[ballIndex];
          const color = getBallColor(ballNumber);
          circle.className = `drawn-ball ${color.class}`;
          circle.style = color.css;
          circle.setAttribute('data-number', ballNumber);
          circle.setAttribute('aria-label', `${color.name} ball number ${ballNumber}`);
        } else if (points === 150 || points === 3) {
          circle.className = 'blue-star-selected';
          circle.style = '';
          circle.removeAttribute('data-number');
          circle.setAttribute('aria-label', `Selected ${points} point`);
        } else {
          circle.className = 'black-circle';
          circle.style = '';
          circle.removeAttribute('data-number');
          circle.setAttribute('aria-hidden', 'true');
        }
      });
    }

    // Update display based on gameState
    async function updateDisplay(ballNumber = null) {
      roundNumber.textContent = gameState.gameId || '...';

      if (ballNumber !== null) {
        await animateBall(ballNumber);
      }

      updatePointsCircles();
      updateRecentBalls();
      renderBallsStatus();
    }

    // Dynamic port detection
    async function getServerPort() {
      try {
        const response = await fetch('http://localhost:3000/port', { signal: AbortSignal.timeout(2000) });
        const data = await response.json();
        return data.port || 3000;
      } catch {
        return 3000;
      }
    }

    // Socket.io connection and event handlers
    let socket;
    async function initSocket() {
      const token = localStorage.getItem('token');
      const port = await getServerPort();
      socket = io(`http://localhost:${port}`, {
        reconnectionAttempts: 5,
        reconnectionDelay: 1000,
        timeout: 10000,
        auth: { token }
      });

      socket.on('connect', () => {
        socket.emit('authenticate', token);
      });

      socket.on('authenticated', ({ role }) => {
        if (role === 'display') {
          socket.emit('requestGameState');
        }
      });

      socket.on('gameState', (state) => {
        gameState = { ...gameState, ...state };
        if (gameState.isRunning && !gameState.isCountingDown) {
          startShaking();
        } else {
          stopShaking();
        }
        updateDisplay();
      });

      socket.on('ballDrawn', async (data) => {
        if (typeof data.number === 'number' && data.number >= 1 && data.number <= 48 && !gameState.drawnBalls.includes(data.number)) {
          gameState.drawnBalls.push(data.number);
          gameState.availableBalls = gameState.availableBalls.filter(b => b !== data.number);
          await updateDisplay(data.number);
        }
      });

      socket.on('gameStarted', (data) => {
        gameState.isRunning = true;
        gameState.isCountingDown = false;
        gameState.gameId = data.gameId;
        gameState.drawnBalls = [];
        gameState.availableBalls = Array.from({length: 48}, (_, i) => i + 1);
        startShaking();
        updateDisplay();
      });

      socket.on('gameReset', () => {
        gameState = {
          gameId: null,
          drawnBalls: [],
          availableBalls: Array.from({length: 48}, (_, i) => i + 1),
          isRunning: false,
          isCountingDown: false,
          bonusBall: null,
          winner: null
        };
        stopShaking();
        updateDisplay();
      });

      socket.on('bonusBall', (bonusBall) => {
        gameState.bonusBall = bonusBall;
        updateDisplay();
      });

      socket.on('winner', (winner) => {
        gameState.winner = winner;
        updateDisplay();
      });
    }

    // Render color betting bar
    function renderColorBettingBar() {
      const bar = document.getElementById('color-betting-bar');
      if (!bar) return;
      bar.innerHTML = '<span>Color Betting</span>';
      colorMap.forEach(color => {
        const dot = document.createElement('div');
        dot.className = `color-dot ${color.class}`;
        dot.title = color.name;
        dot.style = color.css;
        bar.appendChild(dot);
      });
    }

    // On load, connect to server and start shaking
    window.onload = () => {
      renderColorBettingBar();
      initSocket();
      startShaking();
    };
  </script>
</body>
</html>