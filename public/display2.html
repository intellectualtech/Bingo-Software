<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lucky Six Bingo</title>
  <style>
    /* Global resets and basic styles */
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Times New Roman', serif;
      background: #00207a; /* dark blue base */
      background-image: radial-gradient(circle at center, #00369b 0%, #001a4e 100%);
      overflow-x: hidden;
      color: #0d47a1;
      user-select: none;
    }

    /* Container for entire screen */
    .container {
      display: flex;
      flex-direction: column;
      height: 100vh;
      background: #002783 url("https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/e581b58f-d7d3-4009-90a6-a9c868c9d25f.png") no-repeat center center;
      background-size: cover;
      border: 2px solid #001a4e;
      box-shadow: 0 0 15px #001a4e inset;
    }

    /* Top Blue header bar */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(90deg, #030a65 0%, #001a4e 100%);
      border-bottom: 2px solid #3237af;
      height: 48px;
      padding: 0 15px;
      user-select: text;
    }
    /* Title */
    header h1 {
      font-family: Georgia, serif;
      font-size: 28px;
      color: white;
      text-shadow: 2px 2px 3px #000c33;
      margin: 0;
      flex: 1;
      font-weight: normal;
      letter-spacing: 0.05em;
    }

    /* Color betting dots container */
    .color-betting {
      display: flex;
      gap: 12px;
      align-items: center;
      font-size: 13px;
      font-weight: 600;
      color: white;
      font-family: Arial, Helvetica, sans-serif;
      white-space: nowrap;
    }

    .color-betting span {
      margin-right: 10px;
      font-size: 13px;
      font-weight: normal;
      color: white;
      text-shadow: 1px 1px 3px #000;
    }

    .color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 1.5px solid #555;
      box-shadow:
        inset 0 -2px 6px rgba(255, 255, 255, 0.6),
        0 2px 3px rgba(0,0,0,0.8);
      cursor: default;
      flex-shrink: 0;
    }

    /* Colored circles from left to right (purple, yellow, gray, brown, green, red) */
    .color-purple { background: radial-gradient(circle at 6px 6px, #845ec2, #4b216d); }
    .color-yellow { background: radial-gradient(circle at 6px 6px, #f4d35e, #a38621); }
    .color-gray { background: radial-gradient(circle at 6px 6px, #a1a1a1, #5f5f5f); }
    .color-brown { background: radial-gradient(circle at 6px 6px, #8b5e3c, #3e2715); }
    .color-green { background: radial-gradient(circle at 6px 6px, #3a8d44, #115214); }
    .color-red { background: radial-gradient(circle at 6px 6px, #bb3d3d, #6b1f1f); }

    /* Center content area */
    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 15px 50px;
      position: relative;
    }

    /* Left column for round & points */
    .left-col {
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: flex-start;
      gap: 14px;
      width: 130px;
      color: #0d47a1;
      user-select: text;
    }

    /* Round number box style */
    .round-box {
      background: linear-gradient(45deg, #d1d1d1 20%, #969696 50%, #e4e4e4 80%);
      border: 1.8px solid #444;
      border-radius: 14px;
      padding: 8px 20px;
      width: 120px;
      box-shadow: inset 0 3px 10px #fff8, 0 0 6px #0008;
      font-size: 18px;
      text-align: center;
      font-family: serif;
      color: #222;
      user-select: text;
    }
    .round-box small {
      display: block;
      font-size: 11px;
      color: #3a3a3a;
      margin-bottom: 2px;
      font-weight: 600;
    }
    .round-box .round-number {
      font-size: 28px;
      font-weight: 700;
      font-family: 'Georgia', serif;
      text-shadow: 1px 1px 0 #ccc;
    }

    /* Left points list */
    .points-left {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding-left: 32px;
      font-family: 'Times New Roman', serif;
      font-size: 20px;
      font-weight: 600;
      color: #0d47a1;
      user-select: none;
      position: relative;
    }

    .points-left label {
      cursor: default;
      display: flex;
      align-items: center;
      gap: 10px;
      user-select: none;
    }

    .black-circle {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: radial-gradient(circle at 9px 8px, #111 0%, #3a3a3a 60%);
      box-shadow:
        inset 0 2px 3px #0009,
        0 2px 4px #000c;
      border: 1.5px solid #000;
      flex-shrink: 0;
    }

    /* The bigger blue star filled circle for the selected 150 line */
    .blue-star-selected {
      position: relative;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: #0d47a1;
      border: 2px solid #3572e2;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 0 6px #2c59c1;
      flex-shrink: 0;
    }
    /* Star shape in white in center */
    .blue-star-selected::after {
      content: "★";
      font-size: 18px;
      color: #bdd7ff;
      text-shadow: 0 0 5px #4281f5;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      font-weight: 900;
    }

    .blue-star-selected + span {
      color: white;
    }

    /* Points text */
    .points-left label span,
    .points-right label span,
    .points-bottom label span {
      user-select: none;
    }

    /* Center columns with points & black circles */
    .center-columns {
      flex: 1;
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 55px;
      user-select: none;
    }

    .points-column {
      display: flex;
      flex-direction: column;
      gap: 14px;
      font-family: 'Times New Roman', serif;
      font-weight: 600;
      font-size: 18px;
      color: #0d47a1;
    }

    .points-column label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: default;
    }

    /* The black circle for center columns */
    .points-column .black-circle {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: radial-gradient(circle at 7px 7px, #111 0%, #3a3a3a 60%);
      box-shadow:
        inset 0 2px 2px #0009,
        0 1px 5px #0008;
      border: 1.5px solid #000;
      flex-shrink: 0;
    }

    /* Points text in center columns */
    .points-column label span {
      font-size: 18px;
      color: #0d47a1;
      user-select: none;
    }

    /* Right column container */
    .right-col {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 14px;
      width: 130px;
      user-select: text;
      color: #0d47a1;
    }

    /* Jackpot code box style */
    .jackpot-box {
      background: linear-gradient(45deg, #d1d1d1 15%, #a4a4a4 50%, #eee 85%);
      border: 1.8px solid #444;
      border-radius: 14px;
      padding: 8px 20px;
      width: 120px;
      text-align: center;
      font-family: 'Georgia', serif;
      font-size: 24px;
      font-weight: 700;
      user-select: text;
      color: #111;
      box-shadow: inset 0 3px 8px #fff9, 0 0 5px #0007;
    }
    .jackpot-box small {
      display: block;
      font-size: 11px;
      color: #4d4d4d;
      margin-bottom: 2px;
      font-weight: 600;
      user-select: text;
    }

    /* Right points list */
    .points-right {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding-right: 30px;
      font-family: 'Times New Roman', serif;
      font-weight: 600;
      font-size: 20px;
      color: #0d47a1;
      user-select: none;
      position: relative;
    }

    .points-right label {
      cursor: default;
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: flex-end;
    }

    /* Blue star selected marker for right column on number 3 */
    .blue-star-selected-right {
      position: relative;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: #0d47a1;
      border: 2px solid #3572e2;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 0 6px #2c59c1;
      flex-shrink: 0;
    }

    .blue-star-selected-right::after {
      content: "★";
      font-size: 18px;
      color: #bdd7ff;
      text-shadow: 0 0 5px #4281f5;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      font-weight: 900;
    }

    /* Main wheel center container */
    .center-wheel-container {
      position: relative;
      width: 320px;
      height: 320px;
      margin: 0 60px;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
      filter: drop-shadow(0 0 7px #0009);
    }

    /* Outer circle */
    .wheel-outer {
      position: relative;
      width: 320px;
      height: 320px;
      background:
        radial-gradient(circle at center, #d4d4d4 36%, #5f5f5f 60%, #bdbdbd 95%);
      border-radius: 50%;
      box-shadow:
        inset 0 10px 20px #fff9,
        0 0 12px #2229;
      border: 4px solid #6c6c6c;
      overflow: visible;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* Inner mirror black circle sim with reflections */
    .wheel-inner-black {
      position: absolute;
      width: 210px;
      height: 210px;
      background: radial-gradient(circle at 110px 50px, #1d1d1d 20%, #000000 88%);
      border-radius: 50%;
      box-shadow:
        inset 0 0 19px 4px #333,
        inset -4px -2px 19px 2px #555;
      border: 1.8px solid #555;
      z-index: 5;
      overflow: hidden;
    }

    /* Reflection highlight on inner black glass */
    .reflection {
      position: absolute;
      top: 25px;
      right: 40px;
      width: 65px;
      height: 60px;
      background: radial-gradient(ellipse at top right, #fff9 0%, transparent 90%);
      border-radius: 45% 65% 45% 55% / 30% 60% 30% 45%;
      filter: blur(2px);
      pointer-events: none;
      z-index: 11;
    }

    /* Visible balls inside inner black */
    .ball {
      position: absolute;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 1.6px solid #222;
      box-shadow:
        inset 0 2px 3px #fff9,
        0 2px 7px #0008;
      filter: drop-shadow(0 1px 2px #111);
      z-index: 10;
    }
    .ball.green {
      background: radial-gradient(circle at 9px 11px, #5db94a, #2b5b19);
      top: 70px;
      left: 90px;
    }
    .ball.yellow {
      background: radial-gradient(circle at 9px 11px, #ffbd3f, #af7d1e);
      top: 95px;
      left: 140px;
    }
    .ball.gray {
      background: radial-gradient(circle at 9px 11px, #a9a9a9, #5e5e5e);
      top: 120px;
      left: 145px;
    }

    /* Bottom half circle inside */
    .wheel-inner-bottom {
      position: absolute;
      width: 195px;
      height: 104px;
      background: linear-gradient(to top, #0a2a63 0%, #1951a7 70%, #3c6feb 100%);
      border-radius: 0 0 100% 100% / 0 0 100% 100%;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      box-shadow: inset 0 15px 40px #163f9111;
      border-top: 2px solid #3864b0;
      z-index: 6;
    }

    /* Outer 6 black ball circle holder right side */
    .holder-ring {
      position: absolute;
      width: 90px;
      height: 180px;
      border-radius: 45px;
      background: linear-gradient(45deg, #b2b2b2, #737373);
      border: 2px solid #555;
      box-shadow: inset 2px 2px 6px #989898, inset -2px -2px 6px #585858;
      right: -100px;
      top: 60px;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      align-items: center;
      padding: 2px 0;
      z-index: 4;
    }
    .holder-ring .ball-black {
      width: 30px;
      height: 30px;
      background: radial-gradient(circle at 14px 16px, #111, #333);
      border-radius: 50%;
      border: 2px solid #000;
      box-shadow:
        inset 0 2px 4px #0009,
        0 0 6px #000d;
      cursor: default;
    }

    /* Small circle labels on the right */
    .points-right {
      position: relative;
      padding-right: 20px;
    }

    /* Bottom overlay bar */
    footer {
      width: 100%;
      height: 32px;
      background: linear-gradient(90deg, #001e58, #00327a);
      text-align: center;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 14px;
      color: #4972cc;
      line-height: 32px;
      border-top: 2px solid #001067;
      user-select: none;
      display: flex;
      justify-content: space-between;
      padding: 0 26px;
      box-sizing: border-box;
      font-weight: 600;
    }

    /* Using subtle glow for text in footer */
    footer div {
      text-shadow: 0 0 4px #2a3f93;
    }

  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Lucky Six Bingo</h1>
      <div class="color-betting" title="Color Betting">
        <span>Color Betting</span>
        <div class="color-dot color-purple" title="Purple"></div>
        <div class="color-dot color-yellow" title="Yellow"></div>
        <div class="color-dot color-gray" title="Gray"></div>
        <div class="color-dot color-brown" title="Brown"></div>
        <div class="color-dot color-green" title="Green"></div>
        <div class="color-dot color-red" title="Red"></div>
      </div>
    </header>

    <main>
      <div class="left-col" aria-label="Left Points and Round Number">
        <div class="round-box" aria-label="Round number">
          <small>Round No.</small>
          <span class="round-number">178</span>
        </div>
        <div class="points-left" aria-label="Points on left side">
          <label><span class="black-circle" aria-hidden="true"></span><span>10.000</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>7.500</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>5.000</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>2.500</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>1.000</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>500</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>300</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>200</span></label>
          <label>
            <span class="blue-star-selected" aria-label="Selected 150 point"></span>
            <span>150</span>
          </label>
        </div>
      </div>

      <div class="center-wheel-container" aria-label="Center bingo wheel with balls">
        <div class="wheel-outer" role="img" aria-label="Silver metallic bingo cage">
          <div class="wheel-inner-black" aria-hidden="true">
            <div class="reflection"></div>
            <div class="ball green" aria-label="Green ball inside cage"></div>
            <div class="ball yellow" aria-label="Yellow ball inside cage"></div>
            <div class="ball gray" aria-label="Gray ball inside cage"></div>
          </div>
          <div class="wheel-inner-bottom"></div>
        </div>
        <div class="holder-ring" aria-hidden="true">
          <div class="ball-black"></div>
          <div class="ball-black"></div>
          <div class="ball-black"></div>
          <div class="ball-black"></div>
          <div class="ball-black"></div>
          <div class="ball-black"></div>
        </div>
      </div>

      <div class="right-col" aria-label="Right Points and Jackpot Code">
        <div class="jackpot-box" aria-label="Jackpot code">
          <small>Jackpot code</small>
          <span>QWXS</span>
        </div>
        <div class="points-right" aria-label="Points on right side">
          <label><span class="black-circle" aria-hidden="true"></span><span>9</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>8</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>7</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>6</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>5</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>4</span></label>
          <label>
            <span class="blue-star-selected-right" aria-label="Selected 3 number star"></span>
            <span>3</span>
          </label>
          <label><span class="black-circle" aria-hidden="true"></span><span>2</span></label>
          <label><span class="black-circle" aria-hidden="true"></span><span>1</span></label>
        </div>
      </div>
    </main>

    <div class="center-columns" aria-label="Bottom center point columns">
      <div class="points-column" aria-label="Points column 1">
        <label><span class="black-circle" aria-hidden="true"></span><span>100</span></label>
        <label><span class="black-circle" aria-hidden="true"></span><span>90</span></label>
        <label><span class="black-circle" aria-hidden="true"></span><span>80</span></label>
      </div>
      <div class="points-column" aria-label="Points column 2">
        <label><span class="black-circle" aria-hidden="true"></span><span>70</span></label>
        <label><span class="black-circle" aria-hidden="true"></span><span>60</span></label>
        <label><span class="black-circle" aria-hidden="true"></span><span>50</span></label>
      </div>
      <div class="points-column" aria-label="Points column 3">
        <label><span class="black-circle" aria-hidden="true"></span><span>40</span></label>
        <label><span class="black-circle" aria-hidden="true"></span><span>30</span></label>
        <label><span class="black-circle" aria-hidden="true"></span><span>25</span></label>
      </div>
      <div class="points-column" aria-label="Points column 4">
        <label><span class="black-circle" aria-hidden="true"></span><span>20</span></label>
        <label><span class="black-circle" aria-hidden="true"></span><span>15</span></label>
        <label><span class="black-circle" aria-hidden="true"></span><span>10</span></label>
      </div>
    </div>

    <footer>
      <div>Preballs sum (-122,5+)</div>
      <div>ODD/EVEN</div>
      <div>Bonus numbers</div>
    </footer>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.5/socket.io.min.js"></script>
  <script>
    // --- Minimal dynamic state for display2 ---
    let gameState = {
      gameId: null,
      drawnBalls: [],
      availableBalls: Array.from({length: 48}, (_, i) => i + 1),
      isRunning: false,
      isCountingDown: false,
      bonusBall: null,
      winner: null
    };

    // DOM elements
    const roundNumber = document.querySelector('.round-number');
    const ballsInWheel = document.querySelectorAll('.ball');
    // Add more selectors as needed for dynamic updates

    // Dynamic port detection
    async function getServerPort() {
      try {
        const response = await fetch('http://localhost:3000/port', { signal: AbortSignal.timeout(2000) });
        const data = await response.json();
        return data.port || 3000;
      } catch {
        return 3000;
      }
    }

    // Update display based on gameState
    function updateDisplay() {
      // Update round number
      roundNumber.textContent = gameState.gameId || '...';
      // Example: highlight drawn balls in the wheel (if you want)
      ballsInWheel.forEach((el, idx) => {
        const num = idx + 1;
        if (gameState.drawnBalls.includes(num)) {
          el.style.filter = 'brightness(1.5) drop-shadow(0 0 8px gold)';
        } else {
          el.style.filter = '';
        }
      });
      // Add more updates as needed
    }

    // Socket.io connection and event handlers
    let socket;
    async function initSocket() {
      const token = localStorage.getItem('token');
      const port = await getServerPort();
      socket = io(`http://localhost:${port}`, {
        reconnectionAttempts: 5,
        reconnectionDelay: 1000,
        timeout: 10000,
        auth: { token }
      });

      socket.on('connect', () => {
        socket.emit('authenticate', token);
      });

      socket.on('authenticated', ({ role }) => {
        if (role === 'display') {
          socket.emit('requestGameState');
        }
      });

      socket.on('gameState', (state) => {
        gameState = { ...gameState, ...state };
        updateDisplay();
      });

      socket.on('ballDrawn', (data) => {
        if (typeof data.number === 'number') {
          if (!gameState.drawnBalls.includes(data.number)) {
            gameState.drawnBalls.push(data.number);
            gameState.availableBalls = gameState.availableBalls.filter(b => b !== data.number);
            updateDisplay();
          }
        }
      });

      socket.on('gameStarted', (data) => {
        gameState.isRunning = true;
        gameState.isCountingDown = false;
        gameState.gameId = data.gameId;
        updateDisplay();
      });

      socket.on('gameReset', () => {
        gameState = {
          gameId: null,
          drawnBalls: [],
          availableBalls: Array.from({length: 48}, (_, i) => i + 1),
          isRunning: false,
          isCountingDown: false,
          bonusBall: null,
          winner: null
        };
        updateDisplay();
      });

      socket.on('bonusBall', (bonusBall) => {
        gameState.bonusBall = bonusBall;
        updateDisplay();
      });

      socket.on('winner', (winner) => {
        gameState.winner = winner;
        updateDisplay();
      });
    }

    // On load, connect to server
    window.onload = () => {
      initSocket();
    };
  </script>
</body>
</html>

